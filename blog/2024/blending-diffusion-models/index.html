<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Blending Diffusion Models | Lorenzo Olearo </title> <meta name="author" content="Lorenzo Olearo"> <meta name="description" content="How to blend concepts with diffusion models"> <meta name="keywords" content="academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%98%B6%E2%80%8D%F0%9F%8C%AB%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="lorenzo.olearo.com/blog/2024/blending-diffusion-models/"> <script src="/assets/js/theme.js?a5ca4084d3b81624bcfa01156dae2b8e"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Lorenzo <span class="font-weight-bold">Olearo</span> </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">Home </a> </li> <li class="nav-item "> <a class="nav-link" href="/about/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Blending Diffusion Models</h1> <p class="post-meta"> Created in June 06, 2024 </p> <p class="post-tags"> <a href="/blog/2024"> <i class="fa-solid fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/tag/diffusion-models"> <i class="fa-solid fa-hashtag fa-sm"></i> diffusion_models,</a>   <a href="/blog/tag/image-synthesis"> <i class="fa-solid fa-hashtag fa-sm"></i> image_synthesis,</a>   <a href="/blog/tag/blending"> <i class="fa-solid fa-hashtag fa-sm"></i> blending</a>     ·   <a href="/blog/category/research"> <i class="fa-solid fa-tag fa-sm"></i> research</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <h4 id="assume-two-different-concepts-are-given-can-we-blend-them-together-with-diffusion-models">Assume two different concepts are given, can we blend them together with diffusion models?</h4> <p>This is the main research question that we tried to answer in our latest work that will be soon published. Short answer: yes, we can. Long answer: it’s a bit more complicated than that and there are many different ways to do it.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blog/2024-05-11-blending-diffusion-models/blending-lion-BLEND-cat-480.webp 480w,/assets/img/blog/2024-05-11-blending-diffusion-models/blending-lion-BLEND-cat-800.webp 800w,/assets/img/blog/2024-05-11-blending-diffusion-models/blending-lion-BLEND-cat-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/blog/2024-05-11-blending-diffusion-models/blending-lion-BLEND-cat.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> SWITCH blending "lion" with "cat", on the left the lion, on the right the cat, and in the middle their blend. Note that each image is generated by the same exact diffusion pipeline using the same exact initial noise. </div> <p>The paper is currently in press and will be presented at the end of this month, this post is meant to give a brief overview of the work that we have done and the results that we have obtained. I will therefore not go into methodological details, if you are interested feel free to contact me or refer to the paper once it is published. I will update this post with the link to the paper as soon as it is publicly available.</p> <p>Four different methods are explored in our research, one of which, to the best of our knowledge, is novel. The methods are:</p> <ol> <li> <strong>TEXTUAL</strong>: the blend of two different concepts is the linear interpolation of their text embeddings.</li> <li> <strong>SWITCH</strong>: starts the denoising process with one concept and then switches, at some predefined point, to the other concept.</li> <li> <strong>UNET</strong>: at each diffusion step, encode in the U-Net the image latent using the first concept and then decode it using the second one.</li> <li> <strong>ALTERNATE</strong>: uses the first concept for the even diffusion steps and the second one for the odd steps.</li> </ol> <p>Once again, for a detailed explanation, implementation and comparison of this blending method, please refer to the paper.</p> <h4 id="experimental-setup">Experimental setup</h4> <p>Each of the methods illustrated in the paper is implemented from scratch using the Diffusers library, the full implementation is available in my GitHub repository <a href="https://github.com/LorenzoOlearo/blending-diffusion-models" rel="external nofollow noopener" target="_blank">blending-diffusion-models</a></p> <p>The pipelines are implemented with UNet, text-encoder, tokenizer, and VAEs weights from <code class="language-plaintext highlighter-rouge">CompVis/stable-diffusion-v1-4</code>. All of the samples shown here are generated using the same <code class="language-plaintext highlighter-rouge">UniPCMultistepScheduler</code> scheduler at 25 steps.</p> <blockquote> <p>In the following figures, the image on the left is the first prompt, the image on the right is the second prompt, and the image in the middle is the blend of the two with the method indicated in the caption and title.</p> </blockquote> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blog/2024-05-11-blending-diffusion-models/comparison-Fish-BLEND-Tiger-480.webp 480w,/assets/img/blog/2024-05-11-blending-diffusion-models/comparison-Fish-BLEND-Tiger-800.webp 800w,/assets/img/blog/2024-05-11-blending-diffusion-models/comparison-Fish-BLEND-Tiger-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/blog/2024-05-11-blending-diffusion-models/comparison-Fish-BLEND-Tiger.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> UNET blending of "Fish" with "Tiger" </div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blog/2024-05-11-blending-diffusion-models/comparison-Frog-BLEND-Lizard-480.webp 480w,/assets/img/blog/2024-05-11-blending-diffusion-models/comparison-Frog-BLEND-Lizard-800.webp 800w,/assets/img/blog/2024-05-11-blending-diffusion-models/comparison-Frog-BLEND-Lizard-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/blog/2024-05-11-blending-diffusion-models/comparison-Frog-BLEND-Lizard.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> TEXTUAL blending "Frog" with "Lizard" </div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blog/2024-05-11-blending-diffusion-models/comparison-Penguin-BLEND-Lemon-480.webp 480w,/assets/img/blog/2024-05-11-blending-diffusion-models/comparison-Penguin-BLEND-Lemon-800.webp 800w,/assets/img/blog/2024-05-11-blending-diffusion-models/comparison-Penguin-BLEND-Lemon-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/blog/2024-05-11-blending-diffusion-models/comparison-Penguin-BLEND-Lemon.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> UNET blending "penguin" with "lemon" </div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blog/2024-05-11-blending-diffusion-models/comparison-Desk%20lamp-BLEND-Construction%20Crane-480.webp 480w,/assets/img/blog/2024-05-11-blending-diffusion-models/comparison-Desk%20lamp-BLEND-Construction%20Crane-800.webp 800w,/assets/img/blog/2024-05-11-blending-diffusion-models/comparison-Desk%20lamp-BLEND-Construction%20Crane-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/blog/2024-05-11-blending-diffusion-models/comparison-Desk%20lamp-BLEND-Construction%20Crane.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> ALTERNATE blending "Desk lamp" with "Construction Crane" </div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blog/2024-05-11-blending-diffusion-models/comparison-Motherboard-BLEND-Aerial%20view%20of%20a%20city-480.webp 480w,/assets/img/blog/2024-05-11-blending-diffusion-models/comparison-Motherboard-BLEND-Aerial%20view%20of%20a%20city-800.webp 800w,/assets/img/blog/2024-05-11-blending-diffusion-models/comparison-Motherboard-BLEND-Aerial%20view%20of%20a%20city-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/blog/2024-05-11-blending-diffusion-models/comparison-Motherboard-BLEND-Aerial%20view%20of%20a%20city.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> SWITCH blending "Motherboard" with "Aerial view of a city" </div> <h4 id="conclusions">Conclusions</h4> <p>The results of this research show that diffusion models can blend different concepts, however, from our findings, there is no definitive method to do so. Each of them exhibits different behaviors and effects as results vary depending on the semantical distance between the two concepts, as well as the spatial similarity of the two images synthesized from the respective prompts.</p> <p>This research is part of my Master’s thesis on understanding the spatial behavior of Diffusion Models. If you are interested in this topic and would like to collaborate feel free to contact me through any of the contacts at the bottom of this page. I will update the post with the link to the paper as soon as it is published. Stay tuned!</p> </div> </article> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container-contact-message"> Feel free to reach out from any of the contacts below! </div> <div class="social"> <div class="contact-icons"> <a href="mailto:%6C%6F%72%65%6E%7A%6F.%6F%6C%65%61%72%6F@%6F%6C%65%61%72%6F.%63%6F%6D" title="email"><i class="fa-solid fa-envelope"></i></a> <a href="https://orcid.org/0009-0000-7290-3549" title="ORCID" rel="external nofollow noopener" target="_blank"><i class="ai ai-orcid"></i></a> <a href="https://scholar.google.com/citations?user=qc6CJjYAAAAJ" title="Google Scholar" rel="external nofollow noopener" target="_blank"><i class="ai ai-google-scholar"></i></a> <a href="https://github.com/LorenzoOlearo" title="GitHub" rel="external nofollow noopener" target="_blank"><i class="fa-brands fa-github"></i></a> <a href="https://www.linkedin.com/in/lorenzo-olearo" title="LinkedIn" rel="external nofollow noopener" target="_blank"><i class="fa-brands fa-linkedin"></i></a> <a href="https://instagram.com/lollo.sh" title="Instagram" rel="external nofollow noopener" target="_blank"><i class="fa-brands fa-instagram"></i></a> </div> <div class="contact-note"></div> </div> <div class="container"> © Copyright 2024 Lorenzo Olearo. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: July 26, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?b7816bd189846d29eded8745f9c4cf77"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.min.js" integrity="sha256-rjmgmaB99riUNcdlrDtcAiwtLIojSxNyUFdl+Qh+rB4=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?fa0110e8b42cec56ce96d912fd4bde74"></script> <script>addBackToTop();</script> </body> </html>